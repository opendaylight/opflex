{
  "comments": [
    {
      "key": {
        "uuid": "9af3cbac_b29529f4",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2591,
      "author": {
        "id": 8294
      },
      "writtenOn": "2020-04-18T04:57:05Z",
      "side": 1,
      "message": "Could you consolidate the number of debugs in this function, errors are fine. Just the ones that are printed for every service.",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09f78fe8_e35be58d",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2591,
      "author": {
        "id": 8577
      },
      "writtenOn": "2020-04-18T05:05:15Z",
      "side": 1,
      "message": "Sure, i will consolidate the debugs.",
      "parentUuid": "9af3cbac_b29529f4",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1577d8ea_4b68cd2b",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2591,
      "author": {
        "id": 8577
      },
      "writtenOn": "2020-04-18T05:30:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "09f78fe8_e35be58d",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a2d23f0a_865eeb9d",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2792,
      "author": {
        "id": 8294
      },
      "writtenOn": "2020-04-18T04:57:05Z",
      "side": 1,
      "message": "In what context is this function called ? Is it possible that a different thread is servicing programServiceSnatDnatFlows via handleServiceUpdate ? Cant you do the programming there itself ?",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "62924947_6c89da15",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2792,
      "author": {
        "id": 8577
      },
      "writtenOn": "2020-04-18T05:05:15Z",
      "side": 1,
      "message": "hi Madhu, this can be called via handleEndpointUpdate() and handleServiceUpdate(). I have to look at EP updates to check if the NH IP is same as EP IP. Only in that case, we collect stats (with that EP\u0027s annotations in prometheus) or create stats flows in general (for cluster services as well).",
      "parentUuid": "a2d23f0a_865eeb9d",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "75af8e58_d4752b52",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2792,
      "author": {
        "id": 8294
      },
      "writtenOn": "2020-04-18T05:19:30Z",
      "side": 1,
      "message": "I see. So if I am understanding it right, lets say a service has two backends (A, B) In this case this function would get called 3 times one each for service, A, B with the same service uuid ?",
      "parentUuid": "62924947_6c89da15",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97ebd828_a53d26b8",
        "filename": "agent-ovs/ovs/IntFlowManager.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2792,
      "author": {
        "id": 8577
      },
      "writtenOn": "2020-04-18T05:28:11Z",
      "side": 1,
      "message": "If there is a service update, then we call updateSvcExtStatsFlows() once. At that time, if we check if the backends A,B are local EPs and if so, we collect the pod specific attributes for prometheus annotation. \n\nIf there is an Endpoint update, then we call updateSvcExtStatsFlows() for all services, but process only if the service is external. \n\nSince we collect stats at target pods only, we program flows and allocate cookies only if the NH is a local EP.",
      "parentUuid": "75af8e58_d4752b52",
      "revId": "5bc8d0ed1225bcc2ccda6c6f5a40d41f53c24539",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": true
    }
  ]
}