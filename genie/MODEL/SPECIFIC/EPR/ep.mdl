module[epr]
{
    type[name=Context; super=reference/URI]
    type[name=L2Context; super=epr/Context]
    type[name=L3Context; super=epr/Context]
    type[name=GroupContext; super=epr/Context]

    # Superclass for all end points declared in the epr universes.
    # End point is a networking device attaching to the network
    # as part of group
    class[EndPoint;
          abstract;
          ]
    {
        # context in which end-point has been detected (like port)
        member[uuid; type=reference/UUID]

        # mac address of the end-point
        member[mac; type=address/MAC]
    }

    # abstraction of local end-point identifies an end-point that is locally discovered.
    class[LocalEp;
          super=epr/EndPoint;
          abstract
          ]


    # abstraction of externally reportable ep
    class[ReportedEp;
          super=epr/EndPoint;
          abstract
          ]
    {
        member[group; type=epr/GroupContext]
    }

    # L2 end-point that is part of the L2 universe
    class[L2Ep;
          super=epr/ReportedEp;
          concrete
          ]
    {
        # L2 context for the end-point
        member[context; type=epr/L2Context]

        contained
        {
            parent[class=epr/L2Universe]
        }
        named
        {
            parent[class=*;]
            {
                component[member=context]
                component[prefix=-;member=mac]
            }
        }
    }

    # ip address that belongs to a L2Ep (a mac address).
    # a mac address can have many ip addresses associated with it (interface multi-netting)
    class[L3Net; concrete]
    {
        member[ip; type=address/IP]
        contained
        {
            parent[class=epr/L2Ep]
        }
        named
        {
            parent[class=*;]
            {
                component[member=ip]
            }
        }
    }

    # L3 end-point that is part of the L3 universe
    class[L3Ep;
          super=epr/ReportedEp;
          concrete
          ]
    {
        # ip address of the end-point
        member[ip; type=address/IP]

        # L3 context for the end-point
        member[context; type=epr/L3Context]

        contained
        {
            parent[class=epr/L3Universe]
        }
        named
        {
            parent[class=*;]
            {
                component[member=context]
                component[prefix=-;member=ip]
            }
        }
    }
}