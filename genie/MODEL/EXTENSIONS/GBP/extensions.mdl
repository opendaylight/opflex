module[gbpe]
{
    type[VNid; super=scalar/UInt32]
    type[ClassId; super=scalar/UInt32]

    # represents a set of extensions that specify specific identifiers 
    # used by the data plane of the wire
    class[InstContext;
          super=policy/Definition;
          concrete]
    {
        member[vnid; type=gbpe/VNid]
        member[classid; type=gbpe/ClassId]
        contained
        {
            parent[class=gbp/EpGroup]
            parent[class=gbp/BridgeDomain]
            parent[class=gbp/RoutingDomain]
        }
        named
        {
            parent[class=*;]
            {
                component[prefix=ext-context]
            }
        }
    }

    # Contains additional context for a flood domain
    class[FloodContext;
          super=policy/Definition;
          concrete]
    {
        # The multicast group IP address used for flooding the traffic
        # through the fabric within the flood domain.
        member[multicastGroupIP; type=address/IP]

        contained
        {
            parent[class=gbp/FloodDomain]
        }
        named
        {
            parent[class=*;]
            {
                component[prefix=ext-flood-context]
            }
        }
    }

    class[L24Classifier;
          super=gbp/Classifier;
          concrete]
    {
        contained
        {
            parent[class=policy/Space]
        }

        # ARP opcode
        member[arpOpc; type=arp/Opcode]

        # ethertype
        member[etherT; type=l2/EtherType]

        # IP protocol field
        member[prot; type=l3/IpProt]

        # Source port range [from-to]
        member[sFromPort; type=l4/Port]
        member[sToPort; type=l4/Port]

        # Destination port range [from-to]
        member[dFromPort; type=l4/Port]
        member[dToPort; type=l4/Port]
    }

    # A direction for an interface/flow counter (tx or rx)
    type[CounterDirection; super=scalar/Enum8]
    {
        const[name=rx; value=0]
        const[name=tx; value=1]
    }

    # A set of counters for a network endpoint
    class[EpCounter;
          super=observer/UuidObservable;
          concrete;
          ]
    {
        contained
        {
            parent[class=observer/EpStatUniverse]
        }
        named
        {
            parent[class=*;]
            {
                component[member=uuid]
            }
        }

        # Direction of the counter update (tx or rx)
        member[direction; type=gbpe/CounterDirection]

        # number of packets sent/received
        member[packets; type=scalar/UInt64]

        # the number of dropped packets
        member[drop; type=scalar/UInt64]

        # the number of multicast packets
        member[multicast; type=scalar/UInt64]

        # the number of broadcast packets
        member[broadcast; type=scalar/UInt64]

        # the number of unicast packets
        member[unicast; type=scalar/UInt64]

        # the number of bytes sent/received
        member[bytes; type=scalar/UInt64]
    }

    # universe to hold tunnel endpoints
    class[TunnelEpUniverse;
          super=epr/Universe;
          concrete;
          ]
    {
        named
        {
            parent[class=*;]
            {
                component[prefix=tunnel;]
            }
        }
    }

    # Tunnel endpoints are special endpoints that represent
    # a hypervisor host tunnel terminator
    class[TunnelEp;
          super=epr/ReportedEp;
          concrete;
          ]
    {
        contained
        {
            parent[class=gbpe/TunnelEpUniverse]
        }
        named
        {
            parent[class=*;]
            {
                component[member=uuid]
            }
        }

        # A unique identifer for the endpoint.  Could be related to a
        # UUID for an interface, virtual machine, etc.
        member[uuid; type=reference/UUID]

        # The IP address for the tunnel terminator
        member[terminatorIp; type=address/IP]
    }
}
